<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Overall Equipment Effectiveness</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="relative h-screen text-white font-sans">

  <!-- Video de fondo -->
  <video autoplay muted loop class="absolute w-full h-full object-cover">
    <source src="fondo.mp4" type="video/mp4" />
  </video>

  <!-- Capa oscura -->
  <div class="absolute inset-0 bg-black bg-opacity-50 z-10"></div>

  <!-- Contenido -->
  <div class="relative z-20 flex flex-col justify-between h-full p-6">

    <!-- Encabezado -->
    <div class="flex justify-between items-start">
      <div class="mb-2">
        <div id="ubicacion" class="text-sm text-gray-300">Lima</div>
        <div class="text-xl flex items-center gap-2">
          <span id="icon">☀️</span>
          <div>
            <div id="condition">Nublado</div>
            <div id="temp" class="text-3xl font-bold">--°</div>
          </div>
        </div>
        <div id="hora" class="text-lg font-bold text-white mt-1"></div>
      </div>

      <div class="flex items-center gap-2">
        <span>Hola, <span id="username">Anónimo</span></span>
        <img src="https://i.pravatar.cc/40" class="rounded-full border-2 border-white"/>
      </div>
    </div>

    <!-- Buscador -->
    <div class="flex justify-center mt-6">
      <div class="relative w-2/3 md:w-1/2">
        <input id="searchInput" type="text" placeholder="Buscar..."
          class="w-full bg-white text-black rounded-full px-6 py-3 shadow-lg outline-none" oninput="mostrarSugerencias()" autocomplete="off" />
        <ul id="sugerencias" class="absolute w-full bg-white text-black mt-1 rounded shadow-lg hidden z-50 max-h-40 overflow-auto"></ul>
      </div>
    </div>

    <!-- Resultado si no redirige -->
    <div id="resultadoBusqueda" class="p-4 mt-4 hidden w-full max-w-2xl mx-auto text-sm md:text-base bg-white text-black rounded shadow-lg"></div>

    <!-- Frase motivacional -->
    <p id="frase" class="text-center text-2xl mt-6 font-semibold"></p>
  </div>

  <!-- Scripts -->
  <script>
    // Nombre
    const nombre = localStorage.getItem("userName") || "Anónimo";
    document.getElementById("username").textContent = nombre;

    // Fecha y hora
    function actualizarFechaYHora() {
      const fecha = new Date();
      const dias = ['Domingo','Lunes','Martes','Miércoles','Jueves','Viernes','Sábado'];
      const diaNombre = dias[fecha.getDay()];
      const fechaTexto = `${diaNombre} ${fecha.toLocaleDateString('es-PE')}`;
      const horaTexto = fecha.toLocaleTimeString('es-PE');
      document.getElementById("ubicacion").textContent = `Lima, ${fechaTexto}`;
      document.getElementById("hora").textContent = `Hora actual: ${horaTexto}`;
    }
    actualizarFechaYHora();
    setInterval(actualizarFechaYHora, 1000);

    // Clima
    fetch("https://api.open-meteo.com/v1/forecast?latitude=-12.05&longitude=-77.05&current_weather=true")
      .then(res => res.json())
      .then(data => {
        const w = data.current_weather;
        document.getElementById("temp").textContent = Math.round(w.temperature) + "°";
        document.getElementById("condition").textContent = w.weathercode === 0 ? "Soleado" : "Nublado";
        document.getElementById("icon").textContent = w.weathercode === 0 ? "☀️" : "☁️";
      });

    // Frases
    const frases = [
      "Hoy es un buen día para avanzar.",
      "La constancia vence al talento.",
      "Hazlo con pasión o cambia de camino.",
      "Pequeños pasos, grandes resultados.",
      "Cada esfuerzo cuenta.",
      "Actitud positiva, mente imparable.",
      "Tu disciplina marca la diferencia.",
      "Cree en ti, incluso cuando nadie más lo haga.",
      "Trabaja duro en silencio y deja que el éxito haga ruido.",
      "Tu mejor inversión es tu esfuerzo diario."
    ];
    document.getElementById("frase").textContent = frases[Math.floor(Math.random() * frases.length)];

    // Buscador
    const sugerenciasDisponibles = [
      "Procedimiento para solicitar la reparación de las cosedoras"
    ];

    function mostrarResultado(valor) {
      const limpio = valor.trim().toLowerCase();

      if (
        limpio.includes("cosedora") ||
        limpio.includes("procedimiento") ||
        limpio.includes("reparación")
      ) {
        window.location.href = "resultado.html";
      } else {
        const contenedor = document.getElementById("resultadoBusqueda");
        contenedor.innerHTML = "No se encontraron resultados.";
        contenedor.classList.remove("hidden");
      }
    }

    function mostrarSugerencias() {
      const input = document.getElementById("searchInput");
      const lista = document.getElementById("sugerencias");
      const valor = input.value.toLowerCase();

      lista.innerHTML = "";
      if (valor === "") {
        lista.classList.add("hidden");
        return;
      }

      const filtradas = sugerenciasDisponibles.filter(item =>
        item.toLowerCase().includes(valor)
      );

      if (filtradas.length === 0) {
        lista.classList.add("hidden");
        return;
      }

      filtradas.forEach(opcion => {
        const li = document.createElement("li");
        li.textContent = opcion;
        li.className = "px-4 py-2 hover:bg-gray-200 cursor-pointer";
        li.onclick = () => {
          input.value = opcion;
          lista.classList.add("hidden");
          mostrarResultado(opcion);
        };
        lista.appendChild(li);
      });

      lista.classList.remove("hidden");
    }

    document.getElementById("searchInput").addEventListener("keydown", e => {
      if (e.key === "Enter") {
        mostrarResultado(e.target.value);
      }
    });
  </script>

</body>
</html>
